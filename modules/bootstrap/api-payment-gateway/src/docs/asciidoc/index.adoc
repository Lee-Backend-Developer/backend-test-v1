= 결제 도메인 API 문서
:doctype: book
:icons: font
:source-highlighter: highlight.js
:toc: left
:toclevels: 3
:sectlinks:

[[overview]]
== 개요

나노바나나 페이먼츠 결제 도메인 서버 API 문서입니다.

=== API 기본 정보

- Base URL: `http://localhost:8080`
- Content-Type: `application/json`
- 응답 형식: JSON

[[payment-create]]
== 결제 생성

결제를 생성하고 승인 처리합니다.

=== 요청

`POST /api/v1/payments`

==== 요청 필드

include::{snippets}/payment-create/request-fields.adoc[]

==== 요청 예시

include::{snippets}/payment-create/http-request.adoc[]

=== 응답

==== 응답 필드

include::{snippets}/payment-create/response-fields.adoc[]

==== 응답 예시

include::{snippets}/payment-create/http-response.adoc[]

[[payment-query]]
== 결제 내역 조회

결제 내역을 조회하고 통계 정보를 제공합니다. 커서 기반 페이지네이션을 지원합니다.

=== 요청

`GET /api/v1/payments`

==== 쿼리 파라미터

include::{snippets}/payment-query/query-parameters.adoc[]

==== 요청 예시

include::{snippets}/payment-query/http-request.adoc[]

=== 응답

==== 응답 필드

include::{snippets}/payment-query/response-fields.adoc[]

==== 응답 예시

include::{snippets}/payment-query/http-response.adoc[]

[[payment-status]]
== 결제 상태

결제는 다음과 같은 상태를 가질 수 있습니다:

|===
|상태 |설명

|APPROVED
|승인됨

|FAILED
|실패

|CANCELLED
|취소됨
|===

[[fee-calculation]]
== 수수료 계산

제휴사별 수수료 정책에 따라 수수료가 계산됩니다:

- **비율 수수료**: `amount * percentage`
- **고정 수수료**: `fixedFee`
- **총 수수료**: `비율 수수료 + 고정 수수료` (HALF_UP 반올림)
- **정산 금액**: `amount - 총 수수료`

수수료 정책은 `effective_from` 기준으로 가장 최근 정책이 적용됩니다.
